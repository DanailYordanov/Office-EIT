{% extends 'main/base.html' %}

{% block head %}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/datepicker/1.0.10/datepicker.min.css"
    integrity="sha512-YdYyWQf8AS4WSB0WWdc3FbQ3Ypdm0QCWD2k4hgfqbQbRCJBEgX0iAegkl2S1Evma5ImaVXLBeUkIlP6hQ1eYKQ=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-nice-select/1.1.0/css/nice-select.min.css"
    integrity="sha512-CruCP+TD3yXzlvvijET8wV5WxxEh5H8P4cmz0RFbKK6FlZ2sYl3AEsKlLPHbniXKSrDdFewhbmBK5skbdsASbQ=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />
{% endblock head %}

{% block content_main %}
<form action="{{ url }}" class="form-flex" method="post" autocomplete="off" enctype="multipart/form-data" novalidate>
    {% csrf_token %}
    {{ formset.management_form }}
    <input autocomplete="false" name="hidden" type="text" style="display:none;">

    {% for field in form %}
    <div class="col-12 col-md-8 col-xl-6">
        {% if field.field.widget.input_type == 'checkbox' %}

        <label class="form-check-label" for="{{ field.id_for_label }}">
            {{ field.label_tag }}
        </label>
        {{ field }}

        {% else %}

        <div class="field-label">
            {{ field.label_tag }}
        </div>
        <div class="field">
            {{ field }}

            {% if field.name == 'from_to' %}
            <datalist id="datalistFromTo">
                {% for from_to in from_to_list %}
                <option value="{{ from_to }}"></option>
                {% endfor %}
            </datalist>
            {% endif %}

        </div>
        {{ field.errors }}

        {% endif %}
    </div>
    {% endfor %}

    {% for formset_field in formset %}
    <div class="col-12 form-flex adress-form">
        <p class="fw-light text-center fs-4">Адрес</p>
        {% for f in formset_field %}
        {% if f.field.widget.input_type != 'hidden' %}
        <div class="col-12 col-md-8 col-xl-6 address-field">
            {% if f.field.widget.input_type == 'checkbox' %}

            <label class="form-check-label" for="{{ f.id_for_label }}">
                {{ f.label_tag }}
            </label>
            {{ f }}

            {% else %}

            <div class="field-label">
                {{ f.label_tag }}
            </div>
            <div class="field">
                {{ f }}
                {% if f.name == 'address_input' %}
                <datalist id="datalistAddresses">
                    {% for address in addresses %}
                    <option value="{{ address }}"></option>
                    {% endfor %}
                </datalist>
                {% endif %}
            </div>
            {{ f.errors }}

            {% endif %}
        </div>
        {% else %}
        {{ f }}
        {% endif %}
        {% endfor %}
    </div>
    {% endfor %}
    <a href="#" class="text-decoration-none text-center" id="addCourseBtn">
        Добави адрес
        <i class="fas fa-plus ms-1"></i>
    </a>

    <button type="submit" class="btn btn-primary">Изпращане</button>
</form>
{% endblock content_main %}

{% block scripts %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-nice-select/1.1.0/js/jquery.nice-select.min.js"
    integrity="sha512-NqYds8su6jivy1/WLoW8x1tZMRD7/1ZfhWG/jcRQLOzV1k1rIODCpMgoBnar5QXshKJGV7vi0LXLNXPoFsM5Zg=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/datepicker/1.0.10/datepicker.min.js"
    integrity="sha512-RCgrAvvoLpP7KVgTkTctrUdv7C6t7Un3p1iaoPr1++3pybCyCsCZZN7QEHMZTcJTmcJ7jzexTO+eFpHk4OCFAg=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script>
    $(function () {
        $('select').niceSelect();
        $(".date-picker").datepicker({
            format: 'yyyy-mm-dd',
        });
    });
</script>
{% endblock scripts %}